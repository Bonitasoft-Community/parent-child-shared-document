{"designerVersion":"1.2.18","favorite":false,"id":"customGetContextWidget","name":"getContextWidget","lastUpdate":1459770797673,"template":"","controller":"function ($scope, $http) {\n    // Try to get case context assuming that case is still running\n    $http.get('../API/bpm/case/'+$scope.properties.caseId+'/context').\n    success(function(caseContextData, caseContextStatus, caseContextHeader, caseContextConfig) {\n        // API call successful, return the context\n        $scope.properties.context = caseContextData;\n    }).\n    error(function(caseContextData, caseContextStatus, caseContextHeader, caseContextConfig) {\n        // If it fail we assume that case is actually archived\n        // Get the archived case id from old running case id (<=> source object id)\n        $http.get('../API/bpm/archivedCase?p=0&c=1&f=sourceObjectId='+$scope.properties.caseId).\n        success(function(archivedCaseData, archivedCaseStatus, archivedCaseHeader, archivedCaseConfig) {\n            // API call successful.\n            // Get from the answer the archived case id and call the API again to get the archived case context\n            $http.get('../API/bpm/archivedCase/'+archivedCaseData[0].id+'/context').\n            success(function(archivedContextData, archivedContextStatus, archivedContextHeader, archivedContextConfig) {\n                // API call successful, return the context of the archived case\n                $scope.properties.context = archivedContextData;\n            }).\n            error(function(archivedContextData, archivedContextStatus, archivedContextHeader, archivedContextConfig) {\n                console.error(\"Fail to get archived case context for archived case id: \" + archivedCaseData[0].id);\n            });\n        }).\n        error(function(archivedCaseData, archivedCaseStatus, archivedCaseHeader, archivedCaseConfig) {\n            console.error(\"Fail to archived case for source object id: \"+$scope.properties.caseId);\n        });\n    });\n}","description":"This widget will update the context variable with case context information no matter if case is running or archived.\nThis is mainly useful when creating an overview form.\nProvided case id is the id of the running case or source object id for an archived case.","custom":true,"properties":[{"label":"Case id","name":"caseId","type":"text","bond":"expression"},{"label":"Case or archived case context","name":"context","type":"text","bond":"variable"}],"assets":[]}